---
title: "Introduction to `ggplot2`"
author: "Data Science for Biologists"
output: 
  learnr::tutorial:
    css: css/custom-css.css
    toc: true
    toc_float: true
    progressive: true
    allow_skip: true
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, collapse=TRUE)
library(learnr)
library(tidyverse) 
#library(introverse)
tutorial_options(exercise.lines = 6)



sparrows <- tibble::tribble(
  ~Sex,~Age,~Survival,~Length,~Wingspread,~Weight,~Skull_Length,~Humerus_Length,~Femur_Length,~Tarsus_Length,~Sternum_Length,~Skull_Width,
"Male","Adult","Alive",154,241,24.5,31.2,17.4,17,26,21.1,14.9,
"Male","Adult","Alive",160,252,26.9,30.8,18.7,18,30,21.4,15.3,
"Male","Adult","Alive",155,243,26.9,30.6,18.6,17.9,29.2,21.5,15.3,
"Male","Adult","Alive",154,245,24.3,31.7,18.8,17.5,29.1,21.3,14.8,
"Male","Adult","Alive",156,247,24.1,31.5,18.2,17.9,28.7,20.9,14.6,
"Male","Adult","Alive",161,253,26.5,31.8,19.8,18.9,29.1,22.7,15.4,
"Male","Adult","Alive",157,251,24.6,31.1,18.8,18.7,29.3,21.9,15.5,
"Male","Adult","Alive",159,247,24.2,31.4,18.5,18.2,28.6,20.1,15.5,
"Male","Adult","Alive",158,247,23.6,29.8,17.9,17.1,27.4,20.8,15.3,
"Male","Adult","Alive",158,252,26.2,32,19,18.8,29.3,21.8,15.6,
"Male","Adult","Alive",160,252,26.2,32,18.8,18.4,28.7,22.7,15.8,
"Male","Adult","Alive",162,253,24.8,32.3,19.5,19.1,28.8,23.4,16.1,
"Male","Adult","Alive",161,243,25.4,31.8,18.3,18.3,28.6,22.6,15.2,
"Male","Adult","Alive",160,250,23.7,29.8,18.5,17.9,28,20.8,15,
"Male","Adult","Alive",159,247,25.7,31.4,18.5,18.2,29,23.5,15,
"Male","Adult","Alive",158,253,25.7,31.9,18.9,17.8,29.2,21.8,15.2,
"Male","Adult","Alive",159,247,26.5,31.6,18.6,18.1,29.3,23.4,15.5,
"Male","Adult","Alive",166,253,26.7,32.5,19.5,19.4,31.2,22.3,15.2,
"Male","Adult","Alive",159,247,23.9,31.4,19.1,18.4,28.3,21,15.3,
"Male","Adult","Alive",160,248,24.7,31.3,19.1,18.7,29.9,20.4,15.3,
"Male","Adult","Alive",161,252,28,31.8,19.6,18.6,30.2,22.5,15,
"Male","Adult","Alive",163,251,27.9,31.9,19.5,18.9,29.7,21.8,15.8,
"Male","Adult","Alive",156,242,25.9,32,18.4,18.1,28.3,22.5,15.5,
"Male","Adult","Alive",165,251,25.7,32.2,19.1,18.8,29.5,22,15.6,
"Male","Adult","Alive",160,247,26.6,32.4,18.5,18,28.1,21.2,15,
"Male","Adult","Alive",158,244,23.2,31.6,18.5,18.1,29,22.6,14.9,
"Male","Adult","Alive",160,242,25.7,31.6,18,17.9,28.5,20,15.7,
"Male","Adult","Alive",157,245,26.3,32.2,18.8,18.4,29,21.6,15.1,
"Male","Adult","Alive",159,244,24.3,31.5,18.4,17.7,28.1,21.5,15.6,
"Male","Adult","Alive",160,253,26.7,32.1,18.8,18.1,28.4,21.9,15,
"Male","Adult","Alive",158,245,24.9,31.4,18.4,17.9,28.4,21.7,14.7,
"Male","Adult","Alive",161,247,23.8,31.4,18.7,17.6,28,20,15.3,
"Male","Adult","Alive",160,247,24.6,32.3,19.2,18.9,28.8,23,15.4,
"Male","Adult","Alive",160,247,27,32,19.2,18.7,29.8,22.2,16,
"Male","Adult","Alive",153,241,24.7,32.2,18.5,17.3,27.7,22.5,15,
"Male","Adult","Dead",165,249,26.5,31,18.8,17.9,27.8,21.5,15.4,
"Male","Adult","Dead",160,245,26.1,32,18.7,18,28.2,21.4,15.5,
"Male","Adult","Dead",161,249,25.6,32.3,18.9,18.2,28.7,21,15.3,
"Male","Adult","Dead",162,246,25.9,32.3,18.8,18,28.8,22.1,15.4,
"Male","Adult","Dead",163,250,25.5,32.5,19.1,18.6,30.4,22.6,15.8,
"Male","Adult","Dead",162,247,27.6,31.8,18.6,18.3,28.3,22.1,15.2,
"Male","Adult","Dead",163,246,25.8,31.4,17.5,16.8,27.3,21.2,15.3,
"Male","Adult","Dead",161,246,24.9,30.5,18.8,18.4,28.9,20.4,14.7,
"Male","Adult","Dead",160,242,26,31,18.9,18.1,28.1,20.4,15.2,
"Male","Adult","Dead",162,246,26.5,31.5,18.3,17.7,27.7,20.5,15.4,
"Male","Adult","Dead",160,249,26,31.4,18.4,17.5,27.9,21.6,15.3,
"Male","Adult","Dead",161,250,27.1,31.6,18.7,18.1,28.4,21.6,16,
"Male","Adult","Dead",162,248,25.1,31.9,18.9,18.3,29.3,21.3,15,
"Male","Adult","Dead",165,252,26,32.3,18.4,18,29.1,22.5,15.5,
"Male","Adult","Dead",161,243,25.6,32.5,18,18,28.5,21.1,15.4,
"Male","Adult","Dead",161,244,25,31.3,17.8,17.4,27.5,22.2,15.1,
"Male","Adult","Dead",162,248,24.6,31,18.1,17.8,27.6,21.3,15,
"Male","Adult","Dead",164,244,25,31.2,17.9,17.5,27.3,20.2,15.4,
"Male","Adult","Dead",158,247,26,32,18.5,18,29.1,20.4,15.4,
"Male","Adult","Dead",162,253,28.3,31.8,19.1,18.2,29.3,21.8,15.2,
"Male","Adult","Dead",156,239,24.6,30.5,16.7,16.7,26.5,20.6,14.5,
"Male","Adult","Dead",166,251,27.5,31.5,18.3,17.6,28.4,21.5,15.5,
"Male","Adult","Dead",165,253,31,32.4,19.4,19,30,23,15.6,
"Male","Adult","Dead",166,250,28.3,32.4,19.1,18.2,29.9,23.3,15.4,
"Male","Young","Alive",156,246,24.6,32,18.8,18.7,29.6,21.6,15,
"Male","Young","Alive",156,245,25.5,32.1,19.3,18.2,29.1,20.7,15.7,
"Male","Young","Alive",163,248,24.8,32.2,18.9,18.6,29.6,21.7,15.4,
"Male","Young","Alive",163,248,26.3,33,18.7,17.9,29.2,21.3,15.5,
"Male","Young","Alive",160,250,24.4,31.5,18.9,18.2,29.8,22.7,15.3,
"Male","Young","Alive",156,237,23.3,30.6,17.6,16.9,25.7,19.7,14.9,
"Male","Young","Alive",162,253,26.7,32,19.3,18.6,30.4,22.3,16,
"Male","Young","Alive",163,254,26.4,32,19.5,19,29.6,22.5,15.4,
"Male","Young","Alive",164,251,26.9,32,19.2,18.8,29.7,22.5,15.7,
"Male","Young","Alive",163,244,24.3,31.3,18.2,17.3,27.5,22.7,15.5,
"Male","Young","Alive",160,247,27,31.5,19.4,18.6,29.9,21.5,15.7,
"Male","Young","Alive",160,250,26.8,32.5,19.4,18.5,28.5,21.4,16.1,
"Male","Young","Alive",158,247,24.9,32.4,18.9,18.4,28.9,22,14.9,
"Male","Young","Alive",158,249,26.1,32.2,18.9,18.7,29.2,20.8,15.3,
"Male","Young","Alive",158,243,26.6,32.4,19,18.1,29.5,22.6,15.5,
"Male","Young","Alive",155,237,23.3,30.2,17.4,16.6,25.7,20.2,14.9,
"Male","Young","Dead",160,249,24.2,30.4,18.8,18.2,28.7,21.3,15.7,
"Male","Young","Dead",156,236,26.8,30,17.5,17,27.1,21.1,14.3,
"Male","Young","Dead",158,240,23.5,31,18.2,17.8,28.3,20.4,15.1,
"Male","Young","Dead",166,245,26.9,31.7,18.2,17.7,28.1,21.5,15.3,
"Male","Young","Dead",165,255,28.6,31.5,19.5,18.9,29.8,21.7,15.6,
"Male","Young","Dead",157,238,24.7,31.2,17.3,17.2,29.4,19.5,15.2,
"Male","Young","Dead",164,250,27.3,31.8,19.4,18.4,29.7,21.8,14.9,
"Male","Young","Dead",166,256,25.7,31.7,19.1,19.1,30.1,21.8,15.1,
"Male","Young","Dead",167,255,29,32.2,19.4,18.9,30.4,21.7,16.2,
"Male","Young","Dead",161,246,25,31.5,18.8,18,28.5,21.6,14.9,
"Male","Young","Dead",166,254,27.5,31.4,19.3,18.8,28.5,23.2,15.3,
"Male","Young","Dead",161,251,26,31.5,18.6,18,28.5,21,15,
"Female","Adult","Alive",156,245,25.3,31.6,18.5,18,29.3,20.5,15.7,
"Female","Young","Alive",154,240,22.6,30.4,17.9,17.4,28,19.6,14.8,
"Female","Adult","Alive",153,240,25.1,31,18.4,18.1,28.5,20.6,14.9,
"Female","Young","Alive",153,236,23.2,30.9,17.7,17.2,28.8,20.2,15.1,
"Female","Young","Alive",155,243,24.4,31.5,18.6,18.7,29.7,20.3,15.1,
"Female","Young","Alive",163,247,25.1,32,19,18.6,29.6,20.9,15.3,
"Female","Adult","Alive",157,238,24.6,30.9,18.4,18.5,29.8,20.2,14.9,
"Female","Adult","Alive",155,239,24,32.8,18.6,18.8,29.8,21.2,15.3,
"Female","Adult","Alive",164,248,24.2,32.7,19.1,19.1,30.5,21.1,15.3,
"Female","Young","Alive",158,238,24.9,31,18.8,17.5,27.7,22,15,
"Female","Adult","Alive",158,240,24.1,31.3,18.6,17.9,28.1,22,15,
"Female","Young","Alive",160,244,24,31.1,18.6,18.5,29.3,20.5,15,
"Female","Adult","Alive",161,246,26,32.3,19.2,18.6,29.3,21.8,15.8,
"Female","Adult","Alive",157,245,24.9,32,19.1,18.8,30.1,20,15.1,
"Female","Young","Alive",157,235,25.5,31.5,18.1,17.9,28.8,19.8,15.5,
"Female","Adult","Alive",156,237,23.4,30.9,18,17.6,28.5,20.3,15.6,
"Female","Adult","Alive",158,244,25.9,31.4,18.5,17.9,29.1,21.6,15.2,
"Female","Adult","Alive",153,238,24.2,30.5,18.2,18,28.3,20.9,15.1,
"Female","Adult","Alive",155,236,24.2,30.3,18.5,17.9,28.4,20.1,14.9,
"Female","Adult","Alive",163,246,27.4,32.5,18.6,18.1,29.5,21.9,16,
"Female","Adult","Alive",159,236,24,31.5,18,18.1,28.7,21.5,15.4,
"Female","Adult","Dead",155,240,26.3,31.4,18,18,28.5,20.7,15.6,
"Female","Adult","Dead",156,240,25.8,31.5,18.2,17.2,28.6,20.6,15.2,
"Female","Adult","Dead",160,242,26,32.6,18.8,18.6,29.4,21.7,15.2,
"Female","Young","Dead",152,232,23.2,30.3,17.2,17.3,26.6,19.8,15,
"Female","Adult","Dead",160,250,26.5,31.7,18.8,18.6,30.1,22.5,15.6,
"Female","Young","Dead",155,237,24.2,31,18.5,18.4,28.4,20,15.5,
"Female","Young","Dead",157,245,26.9,32.2,19.5,19.1,31.2,21.4,15.7,
"Female","Young","Dead",165,245,27.7,33.1,19.8,19.2,30.4,22,16.1,
"Female","Young","Dead",153,231,23.9,30.1,17.3,16.8,26.5,19.8,15,
"Female","Young","Dead",162,239,26.1,30.3,18,17.4,27.7,23.1,14.9,
"Female","Young","Dead",162,243,24.6,31.6,18.8,18.5,29.5,21.3,15.4,
"Female","Young","Dead",159,245,23.6,31.8,18.5,17.8,28.7,21.7,15.5,
"Female","Young","Dead",159,247,26,30.9,18.1,16.9,27.9,19,14.7,
"Female","Adult","Dead",155,243,25,30.9,18.5,18.1,28.6,21.3,15.2,
"Female","Adult","Dead",162,252,24.8,31.9,19.1,18.7,30,22.2,15.6,
"Female","Adult","Dead",152,230,22.8,30.4,17.3,16.9,26.5,18.6,14,
"Female","Adult","Dead",159,242,24.8,30.8,18.2,16.9,27.7,20.5,14.6,
"Female","Adult","Dead",155,238,24.6,31.2,17.9,17.8,28,19.3,14.9,
"Female","Young","Dead",163,249,30.5,33.4,19.5,19.5,30.7,22.8,16.3,
"Female","Young","Dead",163,242,24.8,31,18.1,18.1,28.7,20.7,15.4,
"Female","Adult","Dead",156,237,23.9,31.7,18.2,18.2,27.7,20.3,15.5,
"Female","Adult","Dead",159,238,24.7,31.5,18.4,17.8,29.1,20.3,15.2,
"Female","Young","Dead",161,245,26.9,32.1,19.1,17.9,29,20.8,15.4,
"Female","Adult","Dead",155,235,22.6,30.7,17.6,17.6,28.4,19.6,14.8,
"Female","Adult","Dead",162,247,26.1,31.9,19.1,18.7,29.4,20.4,15.7,
"Female","Young","Dead",153,237,24.8,30.6,18.6,18.2,29.8,20.4,15.1,
"Female","Young","Dead",162,245,26.2,32.5,18.5,18.6,28,21.1,15.6,
"Female","Young","Dead",164,248,26.1,32.3,18.8,18,29.4,20.9,15
) %>%
  dplyr::mutate(Age = case_when(
                        Weight < 24 ~ "Juvenile",
                        between(Weight, 24, 25.8) ~ "Young",
                        Weight > 25.8 ~ "Adult")
  ) %>%
  dplyr::mutate(Age = as.factor(Age), 
                Survival = as.factor(Survival), 
                Sex = as.factor(Sex))
```

## Background: The `ggplot2` package

These exercises focus on making _reproducible_ figures using the `ggplot2` package, which is one of several [`tidyverse`](https://tidyverse.tidyverse.org/) packages. To obtain `ggplot2`, you will need to first _install_ the library, and then _load_ the library for use in your current R session. **The library has already been installed for you**, but IF you were to install it, here's what you would do!

The command to install packages is `install.packages()` - you must provide package names _in quotes!_ to this function:
```{r, eval=FALSE}
install.packages("ggplot2")
```
You may see red text going down the console - don't worry! These are just messages indicating the stage of installation; they are not errors. **You only need to run package installation ONCE within a given RStudio Cloud space (or, once on your computer)**. Once it has been installed, you can use the package by loading it when needed.


Once package installation completes, you can load packages for use with the `library()` function (quotes or no quotes, doesn't matter here):
```{r, eval=FALSE}
library(ggplot2)
# or, library("ggplot2), or library('ggplot2')
```

**Again, this has already been run for you in these exercises. All libraries you need have been loaded.**


## Background: Exploring the data with R 

All exercises here will use a pre-loaded dataset called `sparrows`. This dataset was collected in 1898 by Hermon Bumpus, an American biologist working at Brown University . Immediately following a bad winter storm, he collected 136 English house sparrows (some alive, some dead), *Passer domesticus*, and brought them indoors. Of these birds, 64 had died during the storm, but 72 recovered and survived. Bumpus measured the birds' physical traits (in mm or g) and recorded them for future generations of data science students.

**Before you begin the exercises, examine the dataset here!! AS A GENERAL RULE, you should ALWAYS ALWAYS ALWAYS look at data before (and while!) plotting!!**

<div class = "prompt">Begin exploring the dataset by simply running `sparrows`, the name of the pre-defined data frame.</div>
+ On this website ONLY (but not within R console), this table will display interactively so you can scroll across columns. In "real R", there is no "point-and-click".

```{r sparrows, exercise=TRUE}

```


```{r sparrows-solution}
# Literally run this code. No mystery!
sparrows
```

Each row in the dataset records a single *observation* - in other words, each row corresponds to an individual sparrow. Each column contains a variable. 

Use the functions `nrow()`, `ncol()`, and `names()` to quickly see, respectively, the number of rows in the data frame, the number of columns in the data frame, and the column (variable!) names of the data frame. Try it out below:

```{r nrow-sparrows, exercise=TRUE, exercise.lines = 4}

```

```{r nrow-sparrows-solution}
# Run each function with the argument sparrows, and examine the output to see the answers
nrow(sparrows)
ncol(sparrows)
names(sparrows)
```


You can quickly see all the datatypes of the data frame's columns with the function `str()`. Try it below:
```{r str-sparrows, exercise=TRUE, exercise.lines = 4}

```

```{r str-sparrows-solution}
# Provide the function str() with the argument sparrows
str(sparrows)
```

You will see the dataset has three categorical variables that R refers to as "factors." Each of these variables has two *levels*, which means "categories in the categorical variable." In this dataset, for example, the variable `Age` has three levels: "Adult", "Juvenile", and "Young". You will see the remaining 9 variables are all numeric continuous. 

Use the function `summary()` to get something magical: A quick summary of each variable in the dataset! For factor variables, this command tells you the count of each level. For numeric variables, this command gives you the five-number summary and the mean. 
```{r summary-sparrows, exercise=TRUE, exercise.lines = 4}

```


```{r summary-sparrows-hint}
# Provide the function summary() with the argument sparrows
summary(sparrows)
```



Remember, you can examine individual columns with several helpful functions (`summary()` is easily the most comprehensive) using the dollar sign to reference them from the data frame. Run the code below to see this in action, and then adapt the code to look at the variable `Sex` instead of `Wingspread`.

```{r summary-column, exercise=TRUE, exercise.lines = 4}
summary(sparrows$Wingspread)
```

```{r summary-column-solution}
summary(sparrows$Sex)
```


## Set 1: Scatterplots


Scatterplots show the **relationship** between two variables, and they use the `geom_point()` geometry as shown in this example where sparrow `Weight` is plotted *across* sparrow `Wingspread` (_Y goes across X_).

```{r scatter_demo, exercise = TRUE}
ggplot(sparrows) + # Use the sparrows dataset
  aes(x = Wingspread, y = Weight) +  # Specify columns Wingspread and Weight to go on x and y axis. 
  geom_point() # Use points
```

The `geom_point()` geom can accept several visual features, which can either be plainly specified to `geom_point()` or specified as an *aesthetic* if they map to the data. The most important ones are:

+ `color`: Color of points
  + *Certain* types of points can also have a `fill` (question 9 below)
+ `size`: Size of points
+ `shape`: Shape of points
+ For more, run `get_help("geom_point")` in a code chunk here to see the `introverse` docs.

<div class="prompt">Make a scatterplot of femur length across wingspread. Remember: This terminology means _Y across X_.</div>

+ Hint: You may want to use the function `names()` to remind yourself what the relevant column names from the `sparrows` dataset are.

```{r scatter_1, exercise = TRUE}

```

```{r scatter_1-solution}
ggplot(sparrows) + 
  aes(x = Wingspread, y = Femur_Length) +  
  geom_point() 
```

<div class = "prompt">Again make a scatterplot of femur length across wingspread, but make all points the color red.</div>

+ Hint: This is simply coloring points, not mapping color to a variable. Just add the color argument to `geom_point()`. Colors MUST go in QUOTES - `"red"` (or `'red'`), NOT `red`.

```{r scatter_2, exercise = TRUE}

```

```{r scatter_2-solution}
ggplot(sparrows) + 
  aes(x = Wingspread, y = Femur_Length) +  
  geom_point(color = "red") 
```

<div class = "prompt">Again make a scatterplot of femur length across wingspread, but this time color all points _based on survival status_.</div>

+ Hint: This IS mapping a variable to a color, so you need to place your color argument _inside aes()_. 


```{r scatter_3, exercise = TRUE}

```

```{r scatter_3-solution}
ggplot(sparrows) + 
  aes(x = Wingspread, y = Femur_Length, color=Survival) +  
  geom_point() 
```

<br>

#### **ALERT!** 
An *extremely common* bug/typo you can now look forward to doing for the rest of your life is accidentally placing a column *outside* of `aes()`. Here's an example of that bug. 

```{r scatter_sidenote, exercise=TRUE, error=TRUE}
ggplot(sparrows) + 
  aes(x = Wingspread, y = Femur_Length) +  
  geom_point(color=Survival) 
```

```{r scatter_sidenote-solution}
ggplot(sparrows) + 
  aes(x = Wingspread, y = Femur_Length, color=Survival) +  
  geom_point() 
```

**What's going on above exactly?** `ggplot2` can only automatically know that you are referring to a column if it's inside `aes()`. If it's outside an `aes()`, R wants to find a variable with that name. But, `Survival` is not a variable on its own - it only exists as a column within `sparrows`. Try to change and re-run the code so that color is properly mapped to the variable `Survival`.


<div class = "prompt">Again make a scatterplot of femur length across wingspread, but this time color all points based on _weight_ (make sure you are using the correct column name!). Unlike survival, weight is a *numeric continuous* variable so you'll get a gradient of colors rather than a single discrete color for each survival category.</div>

```{r scatter_4, exercise = TRUE}

```

```{r scatter_4-solution}
ggplot(sparrows) + 
  aes(x = Wingspread, y = Femur_Length, color=Weight) +  
  geom_point() 
```


<div class = "prompt">Again make a scatterplot of femur length across wingspread, with points colored based on _weight_. But this time, let's add some more professional labels to the plot using the `labs()` function.</div>

+ Learn more about this function from the `introverse` with this command: `get_help("labs")` (run it below!). Then, apply what you've learned to add the following labels to your plot:
  + Y axis: "Femur Length (mm)"
  + Title: "Scatterplot of sparrow wingspread and femur length"
  + For some extra bells and whistles, try adding a caption or subtitle!!


```{r scatter_5, exercise = TRUE}
ggplot(sparrows) + 
  aes(x = Wingspread, y = Femur_Length, color=Weight) +  
  geom_point() +
  labs(x = "Wingspread (mm)")
```

```{r scatter_5-solution}
ggplot(sparrows) + 
  aes(x = Wingspread, y = Femur_Length, color=Weight) +  
  geom_point() +
  labs(x = "Wingspread (mm)",
       y = "Femur Length (mm)",
       title = "Scatterplot of sparrow wingspread and femur length")
```

<br>

#### **PAUSE!** for an important learning opportunity

Look at the solution code provided for the previous exercise. Below, I write the exact same code again, but *all on one line* (the text is "wrapped" in the window you see, so it appears on multiple lines but technically it is not!). As you will notice, it is _absolutely awful to try and read_. Even though the code is technically correct, it is *poorly organized*, making it extremely challenging to get any coherent sense of what the code is doing. 

```{r scatter_5_oneline, eval=F}
ggplot(sparrows) + aes(x = Wingspread, y = Femur_Length, color=Weight) +geom_point() + labs(x = "Wingspread (mm)", y = "Femur Length (mm)", title = "Scatterplot of sparrow wingspread and femur length")
```

When crafting plots with `ggplot2`, it is **strongly recommended (_yes, you will be graded on this_)** to space out your code like the solutions demonstrate. Every time you add the next function, start a new line. Remember to keep the plus sign `+` at the END of a line! If you don't end a line with the `+`, R will think the command is over - it won't know to check if there's a plus sign coming up. You'll also notice in the `labs()` function, I separate arguments one line at a time, again making sure the comma falls at the END of a line and never at the beginning.

In other words...

```{r ggplot_line_at_a_time, eval=F}
## YES
ggplot(sparrows) + 
  aes(x = Wingspread, y = Femur_Length) +
  geom_point()

## ALSO YES
ggplot(sparrows) + 
  aes(x = Wingspread, 
      y = Femur_Length) +
  geom_point()

## NO - disorganized and hard to read, especially when plots get more complex
ggplot(sparrows) + aes(x = Wingspread, y = Femur_Length) + geom_point()

## NO - this is a BUG in plotting code because you cannot start a line with +
ggplot(sparrows) + 
  aes(x = Wingspread, y = Femur_Length) 
  + geom_point()

```




## Set 2: Visualizing distributions

There are *many* different plotting strategies for visualizing distributions, specifically, *values of a numeric variable.* Some more popular options and their geoms (which link to the documentation!) include...

Plot | Geom (yes, these are links!) | Notes
:----|:-------|:-------
Histogram    | [`geom_histogram()`](https://spielmanlab.github.io/introverse/introverse_docs/ggplot2_geom_histogram.html) | Only ONE axis is specified in `aes()` (usually the x-axis). `ggplot2` takes care of the other axis for you - it *counts and bins on your behalf!* (A close relative is *frequency polygons*)
Density plot | [`geom_density()`](https://spielmanlab.github.io/introverse/introverse_docs/ggplot2_geom_density.html) | Think of this as a smoothened histogram. Same as for histogram, you only specify the X axis.
Boxplot      | [`geom_boxplot()`](https://spielmanlab.github.io/introverse/introverse_docs/ggplot2_geom_boxplot.html) | Best used when making multiple boxplots in a single panel
Strip Plot   | [`geom_jitter()`](https://spielmanlab.github.io/introverse/introverse_docs/ggplot2_geom_jitter.html)  | Or, `geom_point(position = position_jitter())`!
Violin Plot  | [`geom_violin()`](https://spielmanlab.github.io/introverse/introverse_docs/ggplot2_violin.html) | The hybrid child of a density plot and a boxplot, kind of!


**To learn how to make each type of plot, we will visualize the distribution of `Wingspread`.**

<div class = "prompt">Make a histogram of sparrow wingspread using `geom_histogram()`.</div>

+ Remember: You only should specify the x-axis; `ggplot2` will do the y-axis for you since the y-axis is a *statistical transformation* (count).
+ For an added insight, try specifying `Wingspread` as the `y` *instead of* as the `x` aesthetic. `ggplot2` will then make a horizontal histogram!


```{r dist_1, exercise = TRUE}

```

```{r dist_1-solution}
ggplot(sparrows) +
  aes(x = Wingspread) +
  geom_histogram()
```

You will notice that `ggplot2` returns a *warning message* when you make histograms: "`stat_bin()` using `bins = 30`. Pick better value with `binwidth`." This is an EXPECTED AND NORMAL message. It is `ggplot` telling you: I assumed there should be *30 bins* along your X-axis in your histogram. It suggests ONE way you can customize the binning: Using the argument `binwidth` to `geom_histogram()` to specify how wide along the X-axis a bin should be. Alternatively, can also use the argument `bins` to `geom_histogram()` to specify how many bins there should be (its default is 30! Get it?).

<div class = "prompt">Re-create your histogram in five separate versions, each with a different specification to `binwidth`: 0.1, 1, 5, 10, and 20.</div>

+ *Think about* which version(s) represent(s) the data well, and which version(s) is/are just terrible ideas. 
+ For an added challenge, also experiment with the `bins` argument instead of `binwidth`.

```{r dist_2, exercise = TRUE}

```

```{r dist_2-solution}
# binwidth of 0.1
ggplot(sparrows) +
  aes(x = Wingspread) +
  geom_histogram(binwidth = 0.1)

# binwidth of 1
ggplot(sparrows) +
  aes(x = Wingspread) +
  geom_histogram(binwidth = 1)

# binwidth of 5
ggplot(sparrows) +
  aes(x = Wingspread) +
  geom_histogram(binwidth = 5)

# binwidth of 10
ggplot(sparrows) +
  aes(x = Wingspread) +
  geom_histogram(binwidth = 10)

# binwidth of 20
ggplot(sparrows) +
  aes(x = Wingspread) +
  geom_histogram(binwidth = 20)
```
<br>
This is really where variables start to become important: Let's say you have some R code which creates 50 histograms, and you want 15 bins for all histograms (i.e., `geom_histogram(bins = 15)`). One option is to make all plots and write `15` for the argument. This works well..until you change your mind later and decide that maybe 12 would have been better. Rather than having to find and replace all `15`'s, we could just have a variable used in the code, and simply change the variable and have it automatically apply. 

<div class = "prompt"> Run the code below to see (_and understand_) this in action, and then *change* the `my_bins` variable to equal 5, and re-run the code with this new variable definition to see the change.</div>

```{r dist_3, exercise = TRUE}
my_bins <- 15
ggplot(sparrows) +
  aes(x = Wingspread) +
  geom_histogram(bins = my_bins)
```

```{r dist_3-solution}
my_bins <- 5
ggplot(sparrows) +
  aes(x = Wingspread) +
  geom_histogram(bins = my_bins)
```

<div class = "prompt"> How about some colors? Add "just a fill" and "just a color" of your choosing to the plot. This will also help you to see the boundaries of your bins.</div>

+ Remember: For a 2D shape like a bar in a histogram, the **color is outline** and **fill is fill**.
+ Don't forget [all the R colors you can use!!](https://github.com/sjspielman/datascience_for_biologists/raw/master/docs/tutorials/Rcolor.pdf)!
+ After you make your colored and filled histogram, also add "just a size" (use a value below 3, trust me...) to your histogram with the argument `size` to see what this argument does in histograms.
+ **For an added challenge...**
  + Make all your visual features (fill, color, and size) variables to use in your plot rather than the direct values, similar to how you practiced with `my_bins` in the previous question.
  + Make sure to choose _meaningful variable names._ In other words, `my_bins` is a lot more meaningful than `x`! Adopting this "coding best practice" makes your code easier for YOU to read, write, and work with.

```{r dist_4, exercise = TRUE}

```

```{r dist_4-solution}
ggplot(sparrows) +
  aes(x = Wingspread) +
  geom_histogram(color = "chocolate3", fill = "skyblue")

# Added challenge, with size:
ggplot(sparrows) +
  aes(x = Wingspread) +
  geom_histogram(color = "chocolate3", 
                 fill = "skyblue", 
                 size = 2)

# Adding
hist_color <- "chocolate3"
hist_fill <- "skyblue"
hist_line_size <- 2
ggplot(sparrows) +
  aes(x = Wingspread) +
  geom_histogram(color = hist_color, 
                 fill = hist_fill, 
                 size = hist_line_size)

```

<div class = "prompt"> Now make a *density plot* of `Wingspread` using `geom_density()`.</div>

+ Since the y-axis of density plots are a transformed value, leave the `y` aesthetic blank just like for histograms. 
+ *Start off strong by adding "just a FILL" of your choosing to your density plot!!*

```{r dist_5, exercise = TRUE}

```

```{r dist_5-solution}
ggplot(sparrows) +
  aes(x = Wingspread) +
  geom_density(fill = "palegreen4")
```

<div class = "prompt">A common visualization feature we often use, especially in density plots, is to make colors *transparent.* To add transparency to colors, we can use the `alpha` argument *given directly to the relevant geom*. Values of alpha range from 0-1, where 0 is fully transparent and 1 is fully opaque. Add an alpha argument (along with a fill argument!) to `geom_density()` to practice this argument. </div>

+ Again, for an added challenge, make a variable to use for your `alpha` value.

```{r dist_6, exercise = TRUE}

```

```{r dist_6-solution}
density_alpha <- 0.6
ggplot(sparrows) +
  aes(x = Wingspread) +
  geom_density(fill = "palegreen4", alpha = density_alpha)
```

<div class = "prompt"> Let's now look at *both* male and female distributions (variable `Sex`) in one plot. Accomplish this with the same code as before, except add an _aesthetic mapping_ to fill from `Sex`.</div>

+ Compare this plot and the previous plot carefully _in terms of their grammar_ to see why only adding the fill aesthetic accomplished the goal. The x-axis is still `Wingspread`, and the y-axis is still automatically calculated. Therefore, the only distinction between plots is the _fill_.
+ Using `alpha` is a really, really good idea here. If you don't use `alpha`, you can't fully see the distributions. It's such a good idea, that it's _required_. Use trial and error to find a good value between 0-1.
+ You have now made an "overlapping density plot"!

```{r dist_7, exercise = TRUE}

```

```{r dist_7-solution}
ggplot(sparrows) +
  aes(x = Wingspread, fill = Sex) +
  geom_density(alpha = 0.6)
```

<div class = "prompt"> Moving on to *boxplots*: Make a boxplot of Wingspread for each Sex with `geom_boxplot()`, in other words, Wingspread _across_ Sex. Axes are not transformed values in boxplots, so you'll need to specify both an x and y variable.</div>

+ Up your game right away! Can you add "just a fill" and/or "just a color"? Your plot, your choice!


```{r dist_8, exercise = TRUE}

```

```{r dist_8-solution}
# Boxplot with "just" a fill
ggplot(sparrows) +
  aes(x = Sex, y = Wingspread) +
  geom_boxplot(fill = "slateblue3")
```

<div class = "prompt"> Practice making more boxplots (and learning the principles of `ggplot2`) with the following tasks:</div>

+ Instead of "just" a fill, modify the Wingspread boxplot to fill distributions based on `Sex`.
  + Hint: You'll need to add another aesthetic mapping for `Sex` on top of what you already have.
+ Instead of filling by `Sex`, fill by `Survival`, but still keep `Sex` along the x-axis.
  + *After you complete this plot*, really look at it carefully to understand how each aesthetic data mapping contributed to the plot. This is how you can make a *grouped boxplot*, and it all starts with applying the grammar of graphics.
  
```{r dist_9, exercise = TRUE}

```

```{r dist_9-solution}
# Boxplot filled by Sex - don't forget to remove any straggling "just" fills (see next plot)
ggplot(sparrows) +
  aes(x = Sex, y = Wingspread, fill = Sex) +
  geom_boxplot()

# The "just blue" fill will OVERRIDE aes(fill = Sex) - be careful!
ggplot(sparrows) +
  aes(x = Sex, y = Wingspread, fill = Sex) +
  geom_boxplot(fill = "blue")

# Boxplot filled by Survival - make sure you see how the aes mappings lead to the created plot! 
# Confused? Great! That's why you're in a class and not doing this alone! Ask me questions!!!
ggplot(sparrows) +
  aes(x = Sex, y = Wingspread, fill = Survival) +
  geom_boxplot()
```

<div class = "prompt"> Re-make the boxplots above but as a *violin plot* using `geom_violin()`. Your code here will be virtually identical, except for the geom specification. Bravely forge ahead!</div>

```{r dist_10, exercise = TRUE}

```

```{r dist_10-solution}
# Violin with "just" a fill
ggplot(sparrows) +
  aes(x = Sex, y = Wingspread) +
  geom_violin(fill = "slateblue3")

# Violin filled by Sex 
ggplot(sparrows) +
  aes(x = Sex, y = Wingspread, fill = Sex) +
  geom_violin()

# Violin filled by Survival 
ggplot(sparrows) +
  aes(x = Sex, y = Wingspread, fill = Survival) +
  geom_violin()
```

<div class = "prompt"> Let's now practice strip plots, also known as jitter plots since they "jitter" points along the x-axis. Use `geom_jitter()` to make a strip plot of `Wingspread` across `Sex`.</div>

+ You may need to customize the _spacing_ of the points in the strip plot so that it is _totally unambiguous_ which point belongs to which x-axis category. You can do this with the argument `width` to `geom_jitter()`. I have personally found that 0.1-0.3 is usually a nice range for this argument.
+ You may want to change the size of points to make everything cleanly visible. Perhaps the plot would also benefit from some _transparency_ (`alpha`) to the points?
+ The "jittering" to the points is random, so every time you re-make the plot, the specific x-location of the points will change. 
+ Fun fact: `geom_jitter()` is actually just a special version of `geom_point()`, so all point aesthetics apply here. In fact, `geom_jitter()` is just a shortcut for the more annoying-to-write `geom_point(position = position_jitter())`.


```{r dist_11, exercise = TRUE}

```

```{r dist_11-solution}
# Strip plot
ggplot(sparrows) +
  aes(x = Sex, y = Wingspread) +
  geom_jitter()

# narrower width - compare this to the default above to understand how it works!
ggplot(sparrows) +
  aes(x = Sex, y = Wingspread) +
  geom_jitter(width = 0.1)

# want to change the size? practice learning how these arguments modify the plot!
# "trial and error" with arguments like width, size, and alpha is how we make plots appealing and clear! 
ggplot(sparrows) +
  aes(x = Sex, y = Wingspread) +
  geom_jitter(width = 0.1, size = 3, alpha = 0.5)
```

<div class = "prompt"> Re-make the strip plot, but also color by `Survival` (inside `aes()`!). You'll find a result somewhat to the boxplot version of this plot.</div>

+ Think: Why did I say color and not fill, as I did for boxplots and violin plots? You just thought: Ah, it's because here, we have 1-dimensional points, which can only have a color, not fill.
+ Make sure to check the jitter width. Think: Does it need to be tweaked for clear interpretation? You just thought: Definitely, I really need to tweak the width to find the "right" amount.

```{r dist_12, exercise = TRUE}

```

```{r dist_12-solution}
ggplot(sparrows) +
  aes(x = Sex, y = Wingspread, color = Survival) +
  geom_jitter(width = 0.1)

# Bonus information: this is actually just a shortcut for...
ggplot(sparrows) +
  aes(x = Sex, y = Wingspread, color = Survival) +
  geom_point(position = position_jitter(width = 0.1))
```
<br>

## Set 3: Visualizing Amounts/Counts

The most common approach visualizing amounts, or count, data is with barplots, which we will focus on in this set. We use barplots to show the counts in different categories of a categorical variable and/or a discrete numeric variable: the x-axis will display the categories, and the y-axis will have a bar whose height equals the count.

<div class = "prompt"> Just as `ggplot2` is a real pal and does all the binning/counting for you when you call `geom_histogram()`, `ggplot2` will do all the barplot counting for you as well with the function `geom_bar()`. Use `geom_bar()` to make a barplot of the `Survival` counts.</div> 

+ Hint: Survival belongs on the x-axis, and ggplot takes care of the y-axis for you.

```{r bar_1, exercise = TRUE}


```

```{r bar_1-solution}
ggplot(sparrows) +
  aes(x = Survival) +
  geom_bar()
```

<div class = "prompt"> Customize your barplot by adding a color and fill of your choosing. </div>

+ These are NOT mapped aesthetics. Simply provide a color and fill argument to `geom_bar()`.
+ You may also want to experiment with the `width` argument to `geom_bar()` to find a bar width that suits you (choose a number between 0-1), or a `size` argument to customize the size of bar outlines. 

```{r bar_2, exercise = TRUE}


```

```{r bar_2-solution}
ggplot(sparrows) + 
  aes(x = Survival) +
  geom_bar(color = "forestgreen", fill = "beige", width = 0.5)
```

<div class = "prompt"> Again modify this barplot of `Survival`, but make the following changes:</div>


+ Remove the "just a fill" argument, and...
+ Replace it with fill that is an *aesthetic mapping* to `Age`. 
+ You can keep or remove your color per your choice. In the end, you will have made a _grouped barplot_ jointly visualizing counts of Age and Survival.

```{r bar_3, exercise = TRUE}


```

```{r bar_3-solution}
ggplot(sparrows) + 
  aes(x = Survival, fill = Age) +
  geom_bar()
```
<div class = "prompt"> Re-make the plot again, but this time *switch* `Age` and `Survival` to have `Age` on the x-axis and `Survival` as the color. This plot displays the same data but with a different emphasis.</div>


```{r bar_4, exercise = TRUE}


```

```{r bar_4-solution}
ggplot(sparrows) + 
  aes(x = Age, fill = Survival) +
  geom_bar()
```

<div class = "prompt"> By default, `ggplot2` makes "stacked" barplots when there are multiple groups. We can also show them "side-by-side", which is called "dodged", by adding this argument to `geom_bar()`: `geom_bar(position = position_dodge())`</div>


```{r bar_5, exercise = TRUE}


```

```{r bar_5-solution}
ggplot(sparrows) + 
  aes(x = Age, fill = Survival) +
  geom_bar(position = position_dodge())
```

<div class = "prompt"> For fun (so fun!), make it a *horizontal* barplot!! Simply change the `x` mapping to `y` instead, and don't provide an `x` aesthetic.</div>

```{r bar_7, exercise = TRUE}


```

```{r bar_7-solution}
ggplot(sparrows) +
  aes(y = Age, fill = Survival) +
  geom_bar(position = position_dodge())
```


## Set 4: Scatterplots, Part 2

Recall that we make scatterplots with `geom_point()`, and scatterplots are used to show the relationship between two x/y numeric values. In this second scatterplot lesson, we'll learn some additional customization strategies for making scatterplots your own.

 Let's play with point size and shape. [This website](http://www.sthda.com/english/wiki/r-plot-pch-symbols-the-different-point-shapes-available-in-r) shows all the different shapes in R you can use - we specify them with numbers. (Note: this website shows some example plotting using a non-`ggplot2` approach. Ignore that. We only care about the point symbols!) 

<div class = "prompt">The plot below contains larger points at size 2, and points shaped like triangles. First run and understand the template code. Then, modify the code to make the points size 3 and using shape 18 (diamond).</div>

+ Hint: We are literally providing a single size and shape, NOT mapping size and shape to the data! Therefore, they are regular arguments to `geom_point()`, NOT to `aes()`.

```{r scatter2_1, exercise = TRUE}
ggplot(sparrows) + 
  aes(x = Wingspread, y = Femur_Length) +  
  geom_point(size = 2, shape = 17)
```

```{r scatter2_1-solution}
ggplot(sparrows) + 
  aes(x = Wingspread, y = Femur_Length) +  
  geom_point(size = 3, shape = 18)
```

<div class = "prompt"> Shapes 21-25 are actually a little different from other shapes - they can be colored *and filled*. They are therefore like 2D points, so for these point shapes only color means *outline* and fill means *fill*. Re-make the scatterplot but specify shape = 21, and specify a color and fill of your choosing to `geom_point()` to see this in action.</div>

+ Don't forget the magical PDF of all the [R colors](https://github.com/sjspielman/datascience_for_biologists/raw/master/docs/tutorials/Rcolor.pdf) ! Have some fun :)

```{r scatter2_2, exercise = TRUE}

```


```{r scatter2_2-solution}
ggplot(sparrows) + 
  aes(x = Wingspread, y = Femur_Length) +  
  geom_point(shape = 21, color = "navy", fill ="cadetblue")
```


<div class = "prompt">We can actually *save* plots as variables and re-use them! Because `ggplot2` is designed to keep adding plot components on top of one another, we can even add plot components on top of a plot. See it in action below! </div>

+ Hint: The assignment operator can be used in either direction, as long as it points to the *variable name*. `x <- 7` and `7 -> x` are both good!! `x -> 7` is not :(

```{r scatter2_3, exercise=TRUE, exercise.lines = 20}
ggplot(sparrows) + 
  aes(x = Wingspread, y = Femur_Length) +  
  geom_point() -> sparrow_wing_femur_plot # Use the assignment operator in the forward direction for better flow of code!

# Examine the plot first
sparrow_wing_femur_plot

# Next, UNCOMMENT the next line code and run it to see some awesome. IMPORTANT: this does NOT change the definition of `sparrow_wing_femur_plot`

# sparrow_wing_femur_plot + labs(x = "OMG WE ADDED AN X-AXIS LABEL!")

# Once you see how that works, add both x and y axis labels to the plot below in the space below to get a final plot

```

```{r scatter2_3-solution}
ggplot(sparrows) + 
  aes(x = Wingspread, y = Femur_Length) +  
  geom_point() -> sparrow_wing_femur_plot

sparrow_wing_femur_plot + 
  labs(x = "Wingspread (mm)", 
       y = "Femur length (mm)")
```


<div class = "prompt">So far, we have been writing separate lines for the `aes()`. In fact, you can include `aes()` in the initial call to `ggplot()` or to any `geom_` function to specify aesthetics for that geom (as we'll learn soon, you can have multiple geoms in a plot!). The code below demonstrates this concept; Run the code below to understand that you can place `aes()` in many locations.</div>


```{r scatter2_4, exercise=TRUE}
# Place aes in ggplot(). This is EQUIVALENT to aes() on its own line
ggplot(sparrows, aes(x = Wingspread, y = Femur_Length)) +  
  geom_point() 

# Place aes in geom_point(). We'll see soon - this does slightly different things!
ggplot(sparrows) +  
  geom_point(aes(x = Wingspread, y = Femur_Length))
```


<div class = "prompt"> Now, let's add another geom! The function `geom_smooth()` can be used to add a trendline to the plot, using one of several modeling options. To get a line of best fit (aka regression line), use the code `geom_smooth(method = "lm")`. Re-create your scatterplot (no colors or aesthetics besides x and y) but add (literally, add with `+`!) this geom to your plot to show the trendline for your data. </div>

+ By default, `geom_smooth()` will include a 95% confidence interval, (statistical bands for the regression line).
+ You will see that `ggplot2` returns the message: "`geom_smooth()` using formula 'y ~ x'". This is NORMAL and EXPECTED: It is telling you the formula used to calculate the trendline. You can safely ignore it.

```{r scatter2_5, exercise=TRUE}


```


```{r scatter2_5-solution}
# With confidence bands
ggplot(sparrows, aes(x = Wingspread, y = Femur_Length)) +
  geom_point() + 
  geom_smooth(method = "lm")
```


<div class = "prompt"> Let's explore the `geom_smooth()` function further by modifying the plot you made for the previous question in the following ways:</div>
 
+ Include the argument `se=FALSE` to `geom_smooth()` to disable the confidence interval bands (`se` stands for "standard error," which is mathematically very closely related to the confidence interval).
+ Explore what adding `color` and `fill` arguments to `geom_smooth()`. Use these arguments in the same way you'd provide "just a color/fill" to `geom_point()` (these are not mapped aesthetics). 
+ One thing you will discover: `fill` doesn't really do much if `se=FALSE`. Understand why this is by trying lots of code!

```{r scatter2_6, exercise=TRUE}

```


```{r scatter2_6-solution}

# Without confidence bands
ggplot(sparrows, aes(x = Wingspread, y = Femur_Length)) +
  geom_point() + 
  geom_smooth(method = "lm", se = FALSE)


# With confidence bands and color
ggplot(sparrows, aes(x = Wingspread, y = Femur_Length)) +
  geom_point() + 
  geom_smooth(method = "lm", color = "orange")

# With confidence bands and color and fill!
ggplot(sparrows, aes(x = Wingspread, y = Femur_Length)) +
  geom_point() + 
  geom_smooth(method = "lm", color = "orange", fill = "navy")


# Without confidence bands and color, and a useless fill argument
# If there's no confidence band, it doesn't matter if you specify a fill is - there's nothing to fill!
ggplot(sparrows, aes(x = Wingspread, y = Femur_Length)) +
  geom_point() + 
  geom_smooth(method = "lm", se=FALSE, color = "orange", fill = "navy")

```

<div class = "prompt"> Let's combine insights from the previous questions here: *How does `aes()` placement work when your plot has multiple geoms?* This time, we'd like to specify a color aesthetic for `Survival`. Re-build your plot with `geom_point()` and `geom_smooth()` with this aesthetic using three different placements for *the COLOR aes*. For all plots, place the `x` and `y` aesthetics in the initial `ggplot()` call.</div>

+ Place the color aesthetic inside the `ggplot()` function, *along with* `x` and `y`
+ Place the color aesthetic inside the `geom_point()` function *only*
+ Place the color aesthetic inside the `geom_smooth()` function *only*

(Hint: Don't forget to actually put `color = Survival` inside of the `aes()` function, no matter its placement!!!!)

> Insights you gain from this question are CRITICAL to your understanding of `ggplot2`. Don't take this question lightly! Spend some time, take some of your own notes, and ask me questions!

```{r scatter2_7, exercise=TRUE}

```


```{r scatter2_7-solution}
# color aes in initial ggplot call
# BOTH geom_point and geom_smooth know about ("inherit") the color mapping
ggplot(sparrows, aes(x = Wingspread, y = Femur_Length, color = Survival)) +
  geom_point() + 
  geom_smooth(method = "lm")

# color aes in geom_point() call
# ONLY geom_point inherits the color mapping. geom_smooth has no idea, so acts on data as a whole
ggplot(sparrows, aes(x = Wingspread, y = Femur_Length)) +
  geom_point(aes(color = Survival)) + 
  geom_smooth(method = "lm")

# color aes in geom_smooth() call
# ONLY geom_smooth inherits the color mapping. geom_point has no idea, so all points are the same color (default black)
ggplot(sparrows, aes(x = Wingspread, y = Femur_Length)) +
  geom_point() + 
  geom_smooth(method = "lm", aes(color = Survival))
```


<div class = "prompt">Make one more version of this figure that contains the following features:</div>

+ Clean and professional labels using `labs()`
+ *Color* all points based on `Survival`
  + With an included *trendline* for EACH `Survival` level (make sure your aesthetic placement is appropriate!)
+ *Size* all points based on `Weight` (Hint: use `size` as an aesthetic to map the given variable)
+ Make all the points into shape 15
+ **BONUS**: Try changing the [theme](https://ggplot2.tidyverse.org/reference/ggtheme.html)

Once the plot is made, think about these design choices. Just because one *can* add these visual features, does it mean one *should* add these visual features? (Answer: No.) 
Note: Some of the legend colors will come out funky - later, we will learn how to deal with this type of situation.

```{r scatter2_8, exercise = TRUE}

```


```{r scatter2_8-solution}
ggplot(sparrows, aes(x = Wingspread, y = Femur_Length, color = Survival, size = Weight)) +  
  geom_point(shape = 15) + 
  geom_smooth(method = "lm") +
    labs(x = "Wingspread (mm)",
         y = "Femur Length (mm)",
         title = "Scatterplot of sparrow femur length across wingspread ",
         subtitle = "Oh wow is this an ugly plot!")

# With a new theme:
ggplot(sparrows, aes(x = Wingspread, y = Femur_Length, color = Survival, size = Weight)) +  
  geom_point(shape = 15) + 
  geom_smooth(method = "lm") +
    labs(x = "Wingspread (mm)",
         y = "Femur Length (mm)",
         title = "Scatterplot of sparrow femur length across wingspread ",
         subtitle = "Oh wow is this an ugly plot!") +
  theme_classic()

```

